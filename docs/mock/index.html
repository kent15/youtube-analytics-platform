<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YouTube Analytics Tool - UI Mock</title>
  <style>
    /* ===== Reset & Base ===== */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --primary: #6366f1;
      --primary-hover: #4f46e5;
      --primary-light: #e0e7ff;
      --bg: #f8fafc;
      --surface: #ffffff;
      --text: #1e293b;
      --text-secondary: #64748b;
      --border: #e2e8f0;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --radius: 12px;
      --shadow: 0 1px 3px rgba(0,0,0,.06), 0 1px 2px rgba(0,0,0,.04);
      --shadow-lg: 0 10px 15px -3px rgba(0,0,0,.08), 0 4px 6px -4px rgba(0,0,0,.04);
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      min-height: 100vh;
    }

    /* ===== Header ===== */
    .header {
      background: var(--surface);
      border-bottom: 1px solid var(--border);
      padding: 16px 32px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-logo {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 20px;
      font-weight: 700;
      color: var(--text);
      text-decoration: none;
    }

    .header-logo svg { flex-shrink: 0; }

    .header-nav {
      display: flex;
      gap: 8px;
    }

    .nav-item {
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
      cursor: pointer;
      border: none;
      background: none;
      transition: all .15s;
    }

    .nav-item:hover { background: var(--bg); color: var(--text); }
    .nav-item.active { background: var(--primary-light); color: var(--primary); }
    .nav-item.disabled { opacity: .4; cursor: not-allowed; }

    .header-quota {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      color: var(--text-secondary);
    }

    .quota-bar {
      width: 100px;
      height: 6px;
      background: var(--border);
      border-radius: 3px;
      overflow: hidden;
    }

    .quota-fill {
      height: 100%;
      width: 12%;
      background: var(--success);
      border-radius: 3px;
      transition: width .5s;
    }

    /* ===== Main Layout ===== */
    .main { max-width: 1120px; margin: 0 auto; padding: 32px 24px; }

    /* ===== Screens ===== */
    .screen { display: none; }
    .screen.active { display: block; }

    /* ===== Search Screen ===== */
    .hero { text-align: center; padding: 64px 0 48px; }

    .hero h1 {
      font-size: 32px;
      font-weight: 800;
      margin-bottom: 12px;
    }

    .hero p {
      font-size: 16px;
      color: var(--text-secondary);
      max-width: 480px;
      margin: 0 auto 40px;
    }

    .search-box {
      display: flex;
      gap: 12px;
      max-width: 560px;
      margin: 0 auto;
    }

    .search-input {
      flex: 1;
      padding: 14px 20px;
      font-size: 15px;
      border: 2px solid var(--border);
      border-radius: var(--radius);
      outline: none;
      transition: border-color .15s;
      background: var(--surface);
    }

    .search-input:focus { border-color: var(--primary); }

    .search-input::placeholder { color: #94a3b8; }

    .btn {
      padding: 14px 28px;
      font-size: 15px;
      font-weight: 600;
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      transition: all .15s;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: var(--primary);
      color: #fff;
    }

    .btn-primary:hover { background: var(--primary-hover); transform: translateY(-1px); box-shadow: var(--shadow-lg); }

    .btn-secondary {
      background: var(--surface);
      color: var(--text);
      border: 1px solid var(--border);
    }

    .btn-secondary:hover { background: var(--bg); }

    .sample-channels {
      margin-top: 32px;
      display: flex;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    .sample-chip {
      padding: 8px 16px;
      font-size: 13px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 20px;
      cursor: pointer;
      transition: all .15s;
      color: var(--text-secondary);
    }

    .sample-chip:hover { border-color: var(--primary); color: var(--primary); background: var(--primary-light); }

    /* ===== Loading Screen ===== */
    .loading-container {
      text-align: center;
      padding: 120px 0;
    }

    .spinner {
      width: 48px;
      height: 48px;
      border: 4px solid var(--border);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 24px;
    }

    @keyframes spin { to { transform: rotate(360deg); } }

    .loading-steps {
      max-width: 400px;
      margin: 32px auto 0;
      text-align: left;
    }

    .loading-step {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 0;
      font-size: 14px;
      color: var(--text-secondary);
    }

    .loading-step.done { color: var(--success); }
    .loading-step.active { color: var(--text); font-weight: 500; }

    .step-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      flex-shrink: 0;
    }

    .step-icon.pending { background: var(--border); }
    .step-icon.done { background: var(--success); color: #fff; }
    .step-icon.active { background: var(--primary); color: #fff; animation: pulse 1.5s infinite; }

    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .6; } }

    /* ===== Result Screen ===== */
    .result-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      margin-bottom: 32px;
    }

    .channel-profile { display: flex; align-items: center; gap: 20px; }

    .channel-avatar {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary), #a78bfa);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: 700;
      color: #fff;
    }

    .channel-name { font-size: 24px; font-weight: 700; }

    .channel-id {
      font-size: 13px;
      color: var(--text-secondary);
      margin-top: 2px;
      font-family: monospace;
    }

    /* Cards grid */
    .cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 16px; margin-bottom: 32px; }

    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow);
      transition: all .2s;
    }

    .card:hover { box-shadow: var(--shadow-lg); transform: translateY(-2px); }

    .card-label {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: .05em;
      color: var(--text-secondary);
      font-weight: 600;
      margin-bottom: 8px;
    }

    .card-value {
      font-size: 28px;
      font-weight: 800;
    }

    .card-sub {
      font-size: 13px;
      color: var(--text-secondary);
      margin-top: 4px;
    }

    /* Judgement section */
    .section-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .judgement-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 16px;
      margin-bottom: 32px;
    }

    .judgement-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow);
      display: flex;
      align-items: flex-start;
      gap: 16px;
    }

    .judgement-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      flex-shrink: 0;
    }

    .judgement-icon.growing { background: #d1fae5; }
    .judgement-icon.stable  { background: #e0e7ff; }
    .judgement-icon.viral   { background: #fef3c7; }

    .judgement-label {
      font-size: 13px;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .judgement-value {
      font-size: 18px;
      font-weight: 700;
      margin: 4px 0;
    }

    .judgement-desc {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.5;
    }

    /* Badge */
    .badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
    }

    .badge-success { background: #d1fae5; color: #065f46; }
    .badge-warning { background: #fef3c7; color: #92400e; }
    .badge-info    { background: #e0e7ff; color: #3730a3; }
    .badge-danger  { background: #fee2e2; color: #991b1b; }

    /* Video table */
    .table-container {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow);
    }

    .table-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 24px;
      border-bottom: 1px solid var(--border);
    }

    .table-title { font-size: 16px; font-weight: 700; }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    thead th {
      padding: 12px 16px;
      text-align: left;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: .05em;
      color: var(--text-secondary);
      font-weight: 600;
      background: #f8fafc;
      border-bottom: 1px solid var(--border);
      cursor: pointer;
      user-select: none;
      white-space: nowrap;
    }

    thead th:hover { color: var(--text); }

    thead th.sorted { color: var(--primary); }

    tbody td {
      padding: 14px 16px;
      font-size: 14px;
      border-bottom: 1px solid var(--border);
    }

    tbody tr { transition: background .1s; }
    tbody tr:hover { background: #f8fafc; }
    tbody tr:last-child td { border-bottom: none; }

    .video-title-cell { max-width: 300px; }

    .video-title-text {
      font-weight: 500;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: block;
    }

    .video-date { font-size: 12px; color: var(--text-secondary); }

    .num { text-align: right; font-variant-numeric: tabular-nums; }

    /* Sort indicator */
    .sort-arrow { font-size: 10px; margin-left: 4px; }

    /* ===== Error Screen ===== */
    .error-container {
      text-align: center;
      padding: 100px 0;
    }

    .error-icon {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background: #fee2e2;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 24px;
      font-size: 28px;
    }

    .error-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .error-message {
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 24px;
      max-width: 400px;
      margin-left: auto;
      margin-right: auto;
    }

    /* ===== Toast ===== */
    .toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: var(--text);
      color: #fff;
      padding: 14px 24px;
      border-radius: var(--radius);
      font-size: 14px;
      box-shadow: var(--shadow-lg);
      transform: translateY(80px);
      opacity: 0;
      transition: all .3s;
      z-index: 200;
    }

    .toast.show {
      transform: translateY(0);
      opacity: 1;
    }

    /* ===== Trend Graph Section ===== */
    .graph-section { margin-bottom: 32px; }

    .graph-section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .period-tabs {
      display: flex;
      gap: 4px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 3px;
    }

    .period-tab {
      padding: 6px 16px;
      font-size: 13px;
      font-weight: 600;
      border: none;
      border-radius: 6px;
      background: transparent;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all .15s;
    }

    .period-tab:hover { color: var(--text); }
    .period-tab.active { background: var(--surface); color: var(--primary); box-shadow: var(--shadow); }

    .graph-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }

    .graph-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow);
    }

    .graph-card-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 16px;
    }

    .chart-wrap { position: relative; height: 220px; }

    .chart-empty {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 220px;
      color: var(--text-secondary);
      font-size: 14px;
      gap: 8px;
    }

    .chart-empty-icon {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: var(--bg);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }

    @media (max-width: 768px) {
      .graph-grid { grid-template-columns: 1fr; }
      .graph-section-header { flex-direction: column; gap: 12px; align-items: flex-start; }
    }

    /* ===== Responsive ===== */
    @media (max-width: 640px) {
      .header { padding: 12px 16px; }
      .header-nav { display: none; }
      .main { padding: 20px 16px; }
      .hero { padding: 40px 0 32px; }
      .hero h1 { font-size: 24px; }
      .search-box { flex-direction: column; }
      .cards { grid-template-columns: 1fr 1fr; }
      .judgement-grid { grid-template-columns: 1fr; }
      .result-header { flex-direction: column; gap: 16px; }
    }
  </style>
</head>
<body>

  <!-- ===== Header ===== -->
  <header class="header">
    <a class="header-logo" href="#" onclick="showScreen('search')">
      <svg width="28" height="28" viewBox="0 0 28 28" fill="none">
        <rect width="28" height="28" rx="8" fill="#6366f1"/>
        <path d="M11 8l8 6-8 6V8z" fill="#fff"/>
      </svg>
      YouTube Analytics
    </a>

    <nav class="header-nav">
      <button class="nav-item active" id="nav-analysis" onclick="showScreen('search')">
        チャンネル分析
      </button>
      <button class="nav-item disabled" title="フェーズ2で実装予定">
        動画ランキング
      </button>
      <button class="nav-item disabled" title="フェーズ3で実装予定">
        伸び率分析
      </button>
      <button class="nav-item disabled" title="フェーズ4で実装予定">
        競合比較
      </button>
    </nav>

    <div class="header-quota">
      <span>Quota:</span>
      <div class="quota-bar"><div class="quota-fill" id="quotaFill"></div></div>
      <span id="quotaText">1,200 / 10,000</span>
    </div>
  </header>

  <main class="main">

    <!-- ===== Screen: Search ===== -->
    <section class="screen active" id="screen-search">
      <div class="hero">
        <h1>YouTubeチャンネルを分析</h1>
        <p>チャンネルIDを入力するだけで、成長傾向・投稿パターン・バズ依存度を分析します。</p>

        <div class="search-box">
          <input
            type="text"
            class="search-input"
            id="channelInput"
            placeholder="チャンネルID（例: UCm7zKBNZwzjNv-lbcDkTU4Q）"
            spellcheck="false"
          >
          <button class="btn btn-primary" onclick="startAnalysis()">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
              <path d="M11.742 10.344a6.5 6.5 0 10-1.397 1.398l3.85 3.85a1 1 0 001.415-1.415l-3.85-3.85zm-5.242.156a5 5 0 110-10 5 5 0 010 10z"/>
            </svg>
            分析開始
          </button>
        </div>

        <div class="sample-channels">
          <span style="font-size:13px;color:var(--text-secondary);margin-right:4px;">サンプル:</span>
          <button class="sample-chip" onclick="fillChannel('UCZf__ehlCEBPop-_sldpBUQ', 'WIRED')">WIRED</button>
          <button class="sample-chip" onclick="fillChannel('UC_x5XG1OV2P6uZZ5FSM9Ttw', 'Google Developers')">Google Developers</button>
          <button class="sample-chip" onclick="fillChannel('UCm7zKBNZwzjNv-lbcDkTU4Q', 'HikakinTV')">HikakinTV</button>
        </div>
      </div>
    </section>

    <!-- ===== Screen: Loading ===== -->
    <section class="screen" id="screen-loading">
      <div class="loading-container">
        <div class="spinner"></div>
        <h2 style="font-size:20px;font-weight:700;margin-bottom:4px;">分析中...</h2>
        <p style="font-size:14px;color:var(--text-secondary);" id="loadingChannelName">HikakinTV</p>

        <div class="loading-steps" id="loadingSteps">
          <div class="loading-step" data-step="0">
            <span class="step-icon pending"></span>
            チャンネル基本情報を取得中
          </div>
          <div class="loading-step" data-step="1">
            <span class="step-icon pending"></span>
            動画一覧を取得中
          </div>
          <div class="loading-step" data-step="2">
            <span class="step-icon pending"></span>
            動画の詳細統計を取得中
          </div>
          <div class="loading-step" data-step="3">
            <span class="step-icon pending"></span>
            分析結果を算出中
          </div>
        </div>
      </div>
    </section>

    <!-- ===== Screen: Result ===== -->
    <section class="screen" id="screen-result">

      <!-- Channel header -->
      <div class="result-header">
        <div class="channel-profile">
          <div class="channel-avatar" id="resultAvatar">H</div>
          <div>
            <div class="channel-name" id="resultName">HikakinTV</div>
            <div class="channel-id" id="resultId">UCm7zKBNZwzjNv-lbcDkTU4Q</div>
          </div>
        </div>
        <div style="display:flex;gap:8px;">
          <button class="btn btn-secondary" onclick="showScreen('search')">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor"><path d="M6 1a5 5 0 014.383 7.39l2.814 2.813a.75.75 0 01-1.06 1.06L9.323 8.45A5 5 0 116 1zm0 1.5a3.5 3.5 0 100 7 3.5 3.5 0 000-7z"/></svg>
            別のチャンネル
          </button>
          <button class="btn btn-secondary" onclick="showToast('再分析を開始しました（モック）')">
            再分析
          </button>
        </div>
      </div>

      <!-- Basic info cards -->
      <div class="cards">
        <div class="card">
          <div class="card-label">登録者数</div>
          <div class="card-value" id="statSubs">11,200,000</div>
          <div class="card-sub">国内トップクラス</div>
        </div>
        <div class="card">
          <div class="card-label">総再生回数</div>
          <div class="card-value" id="statViews">12,846,320,000</div>
          <div class="card-sub">全動画の累計</div>
        </div>
        <div class="card">
          <div class="card-label">動画本数</div>
          <div class="card-value" id="statVideoCount">4,231</div>
          <div class="card-sub">公開動画</div>
        </div>
        <div class="card">
          <div class="card-label">直近30日の投稿数</div>
          <div class="card-value" id="statRecent">18</div>
          <div class="card-sub">平均 4.5本/週</div>
        </div>
      </div>

      <!-- Aggregated metrics -->
      <div class="cards" style="margin-bottom:32px;">
        <div class="card">
          <div class="card-label">直近投稿の平均再生数</div>
          <div class="card-value" id="statAvgView">1,523,000</div>
          <div class="card-sub">直近30日間の投稿動画</div>
        </div>
      </div>

      <!-- Judgement -->
      <div class="section-title">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="var(--primary)">
          <path d="M10 2a8 8 0 100 16 8 8 0 000-16zm1 11H9v-2h2v2zm0-4H9V5h2v4z"/>
        </svg>
        判定結果
      </div>

      <div class="judgement-grid">
        <div class="judgement-card">
          <div class="judgement-icon growing">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="#059669"><path d="M16 6l2.29 2.29-4.88 4.88-4-4L3 15.59 4.41 17l6-6 4 4 6.3-6.29L23 11V3h-8l1 3z"/></svg>
          </div>
          <div>
            <div class="judgement-label">成長傾向</div>
            <div class="judgement-value">
              伸びている <span class="badge badge-success">Growing</span>
            </div>
            <div class="judgement-desc">直近の再生数がチャンネル平均を上回っており、成長が継続しています。</div>
          </div>
        </div>
        <div class="judgement-card">
          <div class="judgement-icon stable">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="#4f46e5"><path d="M4 15h4v5H4zm6-6h4v11h-4zm6-4h4v15h-4z"/></svg>
          </div>
          <div>
            <div class="judgement-label">投稿頻度</div>
            <div class="judgement-value">
              高頻度 <span class="badge badge-info">High</span>
            </div>
            <div class="judgement-desc">週3本以上の安定した投稿頻度を維持しています。</div>
          </div>
        </div>
        <div class="judgement-card">
          <div class="judgement-icon viral">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="#d97706"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
          </div>
          <div>
            <div class="judgement-label">バズ依存性</div>
            <div class="judgement-value">
              安定型 <span class="badge badge-warning">Stable</span>
            </div>
            <div class="judgement-desc">再生数が特定動画に偏っておらず、安定したパフォーマンスです。</div>
          </div>
        </div>
      </div>

      <!-- Trend Graphs -->
      <div class="graph-section">
        <div class="graph-section-header">
          <div class="section-title" style="margin-bottom:0;">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="var(--primary)">
              <path d="M2 16h16v2H2v-2zm1-1l4-4 3 3 6.5-7L18 8.5V3h-5.5l1.8 1.8L9 10.5 6 7.5l-4 4 1 1z"/>
            </svg>
            推移グラフ
          </div>
          <div class="period-tabs" id="periodTabs">
            <button class="period-tab" data-days="7" onclick="switchPeriod(7)">7日</button>
            <button class="period-tab active" data-days="30" onclick="switchPeriod(30)">30日</button>
            <button class="period-tab" data-days="90" onclick="switchPeriod(90)">90日</button>
          </div>
        </div>

        <div class="graph-grid">
          <div class="graph-card">
            <div class="graph-card-title">登録者数の推移</div>
            <div class="chart-wrap">
              <canvas id="chartSubscribers"></canvas>
            </div>
          </div>
          <div class="graph-card">
            <div class="graph-card-title">総再生回数の推移</div>
            <div class="chart-wrap">
              <canvas id="chartViews"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Video list table -->
      <div class="table-container">
        <div class="table-header">
          <span class="table-title">直近の動画一覧</span>
          <span style="font-size:13px;color:var(--text-secondary);">最新50件</span>
        </div>
        <table>
          <thead>
            <tr>
              <th style="width:40px">#</th>
              <th class="sorted" onclick="sortTable('title')">タイトル <span class="sort-arrow">▼</span></th>
              <th onclick="sortTable('date')">公開日</th>
              <th class="num" onclick="sortTable('views')">再生数</th>
              <th class="num" onclick="sortTable('likes')">高評価</th>
              <th class="num" onclick="sortTable('comments')">コメント</th>
            </tr>
          </thead>
          <tbody id="videoTableBody">
          </tbody>
        </table>
      </div>
    </section>

    <!-- ===== Screen: Error ===== -->
    <section class="screen" id="screen-error">
      <div class="error-container">
        <div class="error-icon">!</div>
        <div class="error-title" id="errorTitle">チャンネルが見つかりません</div>
        <div class="error-message" id="errorMessage">
          指定されたチャンネルID「<span id="errorChannelId"></span>」は存在しないか、非公開に設定されています。IDを確認して再度お試しください。
        </div>
        <button class="btn btn-primary" onclick="showScreen('search')">検索に戻る</button>
      </div>
    </section>

  </main>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
  <script>
    /* ===== Mock Data ===== */
    const MOCK_CHANNELS = {
      'UCm7zKBNZwzjNv-lbcDkTU4Q': {
        name: 'HikakinTV',
        avatar: 'H',
        subs: '11,200,000',
        views: '12,846,320,000',
        videoCount: '4,231',
        recent: '18',
        recentSub: '平均 4.5本/週',
        avgView: '1,523,000',
        growth: { label: '伸びている', badge: 'Growing', class: 'badge-success', desc: '直近の再生数がチャンネル平均を上回っており、成長が継続しています。' },
        frequency: { label: '高頻度', badge: 'High', class: 'badge-info', desc: '週3本以上の安定した投稿頻度を維持しています。' },
        viral: { label: '安定型', badge: 'Stable', class: 'badge-warning', desc: '再生数が特定動画に偏っておらず、安定したパフォーマンスです。' },
        videos: [
          { title: '【大食い】巨大ハンバーガーに挑戦してみた！', date: '2026-02-10', views: '2,340,000', likes: '98,200', comments: '5,120' },
          { title: '新しいiPhoneを全色買ってみた結果...', date: '2026-02-08', views: '3,120,000', likes: '142,000', comments: '8,430' },
          { title: '【検証】100万円分のガチャ引いたら何が出る？', date: '2026-02-06', views: '4,560,000', likes: '203,000', comments: '12,800' },
          { title: '24時間コンビニ生活やってみた', date: '2026-02-04', views: '1,890,000', likes: '76,400', comments: '3,920' },
          { title: '【コラボ】人気YouTuberとゲーム対決！', date: '2026-02-02', views: '2,670,000', likes: '112,000', comments: '6,540' },
          { title: '最新ガジェット10個開封レビュー', date: '2026-01-31', views: '1,430,000', likes: '65,300', comments: '2,870' },
          { title: '【ドッキリ】メンバーにサプライズした結果w', date: '2026-01-29', views: '1,980,000', likes: '89,600', comments: '4,210' },
          { title: '2026年買ってよかったモノTOP10', date: '2026-01-27', views: '2,100,000', likes: '95,400', comments: '5,630' },
        ]
      },
      'UCZf__ehlCEBPop-_sldpBUQ': {
        name: 'WIRED',
        avatar: 'W',
        subs: '15,400,000',
        views: '5,230,100,000',
        videoCount: '7,823',
        recent: '12',
        recentSub: '平均 3.0本/週',
        avgView: '834,000',
        growth: { label: '停滞', badge: 'Stable', class: 'badge-info', desc: '再生数はチャンネル平均と同水準で推移しています。' },
        frequency: { label: '中頻度', badge: 'Medium', class: 'badge-info', desc: '週1〜3本のペースで投稿しています。' },
        viral: { label: 'バズ依存型', badge: 'ViralDependent', class: 'badge-danger', desc: '上位10%の動画が全体再生数の50%以上を占めています。' },
        videos: [
          { title: 'Technique Critique: Pro Chef Reviews Cooking Scenes', date: '2026-02-09', views: '2,890,000', likes: '78,300', comments: '4,200' },
          { title: 'Every Way to Make Coffee (32 Methods)', date: '2026-02-07', views: '1,560,000', likes: '52,100', comments: '3,100' },
          { title: 'Neuroscientist Explains Brain in 5 Levels', date: '2026-02-05', views: '945,000', likes: '41,200', comments: '2,340' },
          { title: 'Why This Smartwatch is Different', date: '2026-02-03', views: '432,000', likes: '18,900', comments: '1,020' },
          { title: 'The Science of Extreme Weather', date: '2026-02-01', views: '678,000', likes: '29,400', comments: '1,870' },
          { title: 'How AI is Changing Medicine', date: '2026-01-30', views: '1,230,000', likes: '56,700', comments: '3,450' },
        ]
      },
      'UC_x5XG1OV2P6uZZ5FSM9Ttw': {
        name: 'Google Developers',
        avatar: 'G',
        subs: '2,400,000',
        views: '312,500,000',
        videoCount: '6,142',
        recent: '4',
        recentSub: '平均 1.0本/週',
        avgView: '42,300',
        growth: { label: '減少', badge: 'Declining', class: 'badge-danger', desc: '直近の再生数がチャンネル平均を下回っており、減少傾向が見られます。' },
        frequency: { label: '低頻度', badge: 'Low', class: 'badge-warning', desc: '週1本未満の投稿頻度です。' },
        viral: { label: '安定型', badge: 'Stable', class: 'badge-warning', desc: '再生数が特定動画に偏っておらず、均一な分布です。' },
        videos: [
          { title: 'What\'s new in Flutter 5.0', date: '2026-02-08', views: '89,000', likes: '4,200', comments: '380' },
          { title: 'Build with AI: Gemini API deep dive', date: '2026-02-01', views: '56,000', likes: '2,800', comments: '210' },
          { title: 'Cloud Next 2026 Keynote Highlights', date: '2026-01-25', views: '34,000', likes: '1,500', comments: '120' },
          { title: 'Android 17 Developer Preview', date: '2026-01-18', views: '123,000', likes: '5,600', comments: '450' },
        ]
      }
    };

    /* ===== Generate Mock Snapshots ===== */
    function generateSnapshots(baseSubs, baseViews, days, trend) {
      const snapshots = [];
      const now = new Date('2026-02-13');
      const dailySubsGrowth = trend === 'growing' ? 3200 : trend === 'declining' ? -800 : 200;
      const dailyViewsGrowth = trend === 'growing' ? 2800000 : trend === 'declining' ? 400000 : 1200000;
      for (let i = days; i >= 0; i--) {
        const d = new Date(now);
        d.setDate(d.getDate() - i);
        const noise = () => (Math.random() - 0.5) * 0.4;
        snapshots.push({
          date: d.toISOString().slice(0, 10),
          subscribers: Math.round(baseSubs - dailySubsGrowth * i * (1 + noise())),
          views: Math.round(baseViews - dailyViewsGrowth * i * (1 + noise()))
        });
      }
      return snapshots;
    }

    // Pre-generate 90-day snapshots for each channel
    MOCK_CHANNELS['UCm7zKBNZwzjNv-lbcDkTU4Q'].snapshots =
      generateSnapshots(11200000, 12846320000, 90, 'growing');
    MOCK_CHANNELS['UCZf__ehlCEBPop-_sldpBUQ'].snapshots =
      generateSnapshots(15400000, 5230100000, 90, 'stable');
    MOCK_CHANNELS['UC_x5XG1OV2P6uZZ5FSM9Ttw'].snapshots =
      generateSnapshots(2400000, 312500000, 90, 'declining');

    /* ===== Chart Instances ===== */
    let chartSubs = null;
    let chartViews = null;
    let currentChannelData = null;
    let currentPeriod = 30;

    /* ===== Screen Management ===== */
    function showScreen(name) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById('screen-' + name).classList.add('active');
    }

    /* ===== Fill Channel ===== */
    function fillChannel(id, name) {
      document.getElementById('channelInput').value = id;
      showToast(name + ' を選択しました');
    }

    /* ===== Start Analysis (Mock) ===== */
    function startAnalysis() {
      const channelId = document.getElementById('channelInput').value.trim();
      if (!channelId) {
        showToast('チャンネルIDを入力してください');
        return;
      }

      const data = MOCK_CHANNELS[channelId];

      // Show loading
      showScreen('loading');
      document.getElementById('loadingChannelName').textContent = data ? data.name : channelId;

      // Reset loading steps
      const steps = document.querySelectorAll('.loading-step');
      steps.forEach(s => {
        s.classList.remove('done', 'active');
        s.querySelector('.step-icon').className = 'step-icon pending';
      });

      // Animate loading steps
      let currentStep = 0;
      const stepInterval = setInterval(() => {
        if (currentStep > 0) {
          const prevStep = steps[currentStep - 1];
          prevStep.classList.remove('active');
          prevStep.classList.add('done');
          prevStep.querySelector('.step-icon').className = 'step-icon done';
          prevStep.querySelector('.step-icon').textContent = '\u2713';
        }
        if (currentStep < steps.length) {
          steps[currentStep].classList.add('active');
          steps[currentStep].querySelector('.step-icon').className = 'step-icon active';
          currentStep++;
        } else {
          clearInterval(stepInterval);
          // Update quota
          updateQuota();
          // Show result or error
          setTimeout(() => {
            if (data) {
              renderResult(channelId, data);
              showScreen('result');
            } else {
              document.getElementById('errorChannelId').textContent = channelId;
              showScreen('error');
            }
          }, 400);
        }
      }, 600);
    }

    /* ===== Render Result ===== */
    function renderResult(channelId, data) {
      document.getElementById('resultAvatar').textContent = data.avatar;
      document.getElementById('resultName').textContent = data.name;
      document.getElementById('resultId').textContent = channelId;
      document.getElementById('statSubs').textContent = data.subs;
      document.getElementById('statViews').textContent = data.views;
      document.getElementById('statVideoCount').textContent = data.videoCount;
      document.getElementById('statRecent').textContent = data.recent;
      document.querySelector('#statRecent').closest('.card').querySelector('.card-sub').textContent = data.recentSub;
      document.getElementById('statAvgView').textContent = data.avgView;

      // Judgements
      const judgements = document.querySelectorAll('.judgement-card');

      const jData = [data.growth, data.frequency, data.viral];
      judgements.forEach((card, i) => {
        card.querySelector('.judgement-value').innerHTML =
          jData[i].label + ' <span class="badge ' + jData[i].class + '">' + jData[i].badge + '</span>';
        card.querySelector('.judgement-desc').textContent = jData[i].desc;
      });

      // Charts
      currentChannelData = data;
      currentPeriod = 30;
      document.querySelectorAll('.period-tab').forEach(t => t.classList.remove('active'));
      document.querySelector('.period-tab[data-days="30"]').classList.add('active');
      // Delay chart render to ensure canvas is visible
      setTimeout(() => renderCharts(data, 30), 50);

      // Video table
      const tbody = document.getElementById('videoTableBody');
      tbody.innerHTML = '';
      data.videos.forEach((v, i) => {
        const tr = document.createElement('tr');
        tr.innerHTML =
          '<td style="color:var(--text-secondary)">' + (i + 1) + '</td>' +
          '<td class="video-title-cell"><span class="video-title-text">' + escapeHtml(v.title) + '</span></td>' +
          '<td class="video-date">' + v.date + '</td>' +
          '<td class="num">' + v.views + '</td>' +
          '<td class="num">' + v.likes + '</td>' +
          '<td class="num">' + v.comments + '</td>';
        tbody.appendChild(tr);
      });
    }

    /* ===== Render Charts ===== */
    function renderCharts(data, days) {
      const snapshots = data.snapshots.slice(-(days + 1));
      const labels = snapshots.map(s => {
        const d = new Date(s.date);
        return (d.getMonth() + 1) + '/' + d.getDate();
      });

      const commonOptions = {
        responsive: true,
        maintainAspectRatio: false,
        interaction: { intersect: false, mode: 'index' },
        plugins: {
          legend: { display: false },
          tooltip: {
            backgroundColor: '#1e293b',
            titleFont: { size: 12 },
            bodyFont: { size: 13 },
            padding: 10,
            cornerRadius: 8,
            callbacks: {
              label: function(ctx) {
                return ctx.parsed.y.toLocaleString();
              }
            }
          }
        },
        scales: {
          x: {
            grid: { display: false },
            ticks: { font: { size: 11 }, color: '#94a3b8', maxTicksLimit: days <= 7 ? 7 : 10 }
          },
          y: {
            grid: { color: '#f1f5f9' },
            ticks: {
              font: { size: 11 },
              color: '#94a3b8',
              callback: function(v) {
                if (v >= 1e9) return (v / 1e9).toFixed(1) + 'B';
                if (v >= 1e6) return (v / 1e6).toFixed(1) + 'M';
                if (v >= 1e3) return (v / 1e3).toFixed(0) + 'K';
                return v;
              }
            }
          }
        },
        elements: {
          point: { radius: days <= 7 ? 4 : days <= 30 ? 2 : 0, hoverRadius: 5 },
          line: { tension: 0.3, borderWidth: 2.5 }
        }
      };

      // Destroy previous charts
      if (chartSubs) chartSubs.destroy();
      if (chartViews) chartViews.destroy();

      chartSubs = new Chart(document.getElementById('chartSubscribers'), {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            data: snapshots.map(s => s.subscribers),
            borderColor: '#6366f1',
            backgroundColor: 'rgba(99,102,241,.08)',
            fill: true
          }]
        },
        options: commonOptions
      });

      chartViews = new Chart(document.getElementById('chartViews'), {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            data: snapshots.map(s => s.views),
            borderColor: '#10b981',
            backgroundColor: 'rgba(16,185,129,.08)',
            fill: true
          }]
        },
        options: commonOptions
      });
    }

    /* ===== Switch Period ===== */
    function switchPeriod(days) {
      currentPeriod = days;
      document.querySelectorAll('.period-tab').forEach(t => t.classList.remove('active'));
      document.querySelector('.period-tab[data-days="' + days + '"]').classList.add('active');
      if (currentChannelData) {
        renderCharts(currentChannelData, days);
      }
    }

    /* ===== Sort Table (Mock) ===== */
    function sortTable(column) {
      showToast('「' + column + '」でソートしました（モック）');
      // Reset sorted class
      document.querySelectorAll('thead th').forEach(th => th.classList.remove('sorted'));
      event.target.closest('th').classList.add('sorted');
    }

    /* ===== Quota Update ===== */
    function updateQuota() {
      const fill = document.getElementById('quotaFill');
      const text = document.getElementById('quotaText');
      const current = parseInt(fill.style.width) || 12;
      const newWidth = Math.min(current + 2, 100);
      fill.style.width = newWidth + '%';
      const used = Math.round(newWidth * 100);
      text.textContent = used.toLocaleString() + ' / 10,000';
      if (newWidth > 80) {
        fill.style.background = 'var(--danger)';
      } else if (newWidth > 50) {
        fill.style.background = 'var(--warning)';
      }
    }

    /* ===== Toast ===== */
    function showToast(msg) {
      const toast = document.getElementById('toast');
      toast.textContent = msg;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 2500);
    }

    /* ===== Escape HTML ===== */
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    /* ===== Enter key support ===== */
    document.getElementById('channelInput').addEventListener('keydown', function(e) {
      if (e.key === 'Enter') startAnalysis();
    });
  </script>

</body>
</html>
